source ../.env
#
rm -f ORP ORTool ORL ORL32
rm -f *.smb *.rsc Modules.bin* *.xxd *.dump Oberon.Log
if [ $# -ne 0 ]; then
  echo "clean"
  exit 0
fi
####
EXES="ORP ORTool ORL"
if [ $O2CARCH -eq 32 ];
then
  EXES="$EXES ORL32"
fi
for x in $EXES
do
  p="../Oberon07/$x"
  if [ -s $p ];
  then
    cp $p $x
  else
    echo "$p not found"
    exit 1
  fi
done
#
./ORP Compile Kernel.Mod.txt FileDir.Mod.txt Files.Mod.txt Modules.Mod.txt
if [ -s ORL32 ];
then
  ./ORL32 Link Modules; mv Modules.bin Modules.bin32
fi
./ORL Link Modules

xxd Modules.bin > Modules.bin.xxd
if [ -s Modules.bin32 ];
then
  xxd Modules.bin32 > Modules.bin32.xxd
fi

for r in Kernel.rsc FileDir.rsc Files.rsc Modules.rsc
do
  ORTool DecObj $r > $r.dump
done
